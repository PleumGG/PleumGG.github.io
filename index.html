<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Test Camera + Three</title>
<style>
body{margin:0;overflow:hidden;background:black;}
video{
  position:fixed;
  right:10px;
  bottom:10px;
  width:200px;
  transform:scaleX(-1);
}
</style>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
</head>

<body>
<video id="video" autoplay playsinline></video>

<script>

console.log("Script loaded")

/* THREE */
const scene = new THREE.Scene()
const camera = new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000)
camera.position.z = 3

const renderer = new THREE.WebGLRenderer()
renderer.setSize(innerWidth,innerHeight)
document.body.appendChild(renderer.domElement)

const cube = new THREE.Mesh(
  new THREE.BoxGeometry(),
  new THREE.MeshNormalMaterial()
)
scene.add(cube)

function animate(){
  requestAnimationFrame(animate)
  cube.rotation.x += 0.01
  cube.rotation.y += 0.01
  renderer.render(scene,camera)
}
animate()

/* MEDIAPIPE */

const video = document.getElementById("video")

navigator.mediaDevices.getUserMedia({video:true})
.then(stream=>{
  video.srcObject = stream
  console.log("Camera working")
})
.catch(err=>{
  console.error("Camera error:",err)
})

</script>
</body>
</html>
